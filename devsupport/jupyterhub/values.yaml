# This file can update the JupyterHub Helm chart's default configuration values.
#
# For reference see the configuration reference and default values, but make
# sure to refer to the Helm chart version of interest to you!
#
# Introduction to YAML:     https://www.youtube.com/watch?v=cdLNKUoMc6c
# Chart config reference:   https://zero-to-jupyterhub.readthedocs.io/en/stable/resources/reference.html
# Chart default values:     https://github.com/jupyterhub/zero-to-jupyterhub-k8s/blob/HEAD/jupyterhub/values.yaml
# Available chart versions: https://hub.jupyter.org/helm-chart/
#
proxy:
  service:
    type: ClusterIP

  chp:
    extraPodSpec:
      dnsConfig:
        options:
          - name: ndots
            value: "1"

ingress:
  enabled: true
  ingressClassName: traefik
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
  hosts:
    - ${jupyterhub_fqdn}

hub:
  config:
    # https://tljh.jupyter.org/en/latest/howto/auth/awscognito.html
    GenericOAuthenticator:
      client_id: ${cognito_app_id}
      client_secret: ${cognito_app_secret}
      oauth_callback_url: https://${jupyterhub_fqdn}/hub/oauth_callback

      authorize_url: https://${cognito_domain}/oauth2/authorize
      token_url: https://${cognito_domain}/oauth2/token
      userdata_url: https://${cognito_domain}/oauth2/userInfo
      logout_redirect_url: https://${cognito_domain}/oauth2/logout

      login_service: AWS Cognito
      username_key: username
      userdata_method: POST

      claim_groups_key: cognito:groups
      allowed_groups:
        - user
      admin_groups:
        - admin

    JupyterHub:
      authenticator_class: generic-oauth
      admin_access: true

  extraPodSpec:
    dnsConfig:
      options:
        - name: ndots
          value: "1"

singleuser:
  cloudMetadata:
    blockWithIptables: true
    ip: 192.80.8.124

  extraPodConfig:
    dnsConfig:
      options:
        - name: ndots
          value: "1"

  scheduling:
    userScheduler:
      extraPodSpec:
        dnsConfig:
          options:
            - name: ndots
              value: "1"